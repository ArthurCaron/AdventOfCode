package io.karon.adventofcode.seventeen;

class Day19 {

	private static final char VERTICAL_LINE = '|';
	private static final char CORNER = '+';
	private static final char HORIZONTAL_LINE = '-';

	static class Star1 {

		static String getResult() {
			char[][] grid = getFormattedInput();
			int x = 0;
			int y = findYStartingPoint(grid);

			StringBuilder stringBuilder = new StringBuilder();
			boolean doContinue = true;

			Direction direction = Direction.BOT;

			while (doContinue) {
				if (direction.isBot() && isBotOkay(grid, x, y)) {
					x += 1;
				} else if (direction.isTop() && isTopOkay(grid, x, y)) {
					x -= 1;
				} else if (direction.isLeft() && isLeftOkay(grid, x, y)) {
					y -= 1;
				} else if (direction.isRight() && isRightOkay(grid, x, y)) {
					y += 1;
				} else {
					if (!direction.isTop() && isBotOkay(grid, x, y)) {
						x += 1;
						direction = Direction.BOT;
					} else if (!direction.isBot() && isTopOkay(grid, x, y)) {
						x -= 1;
						direction = Direction.TOP;
					} else if (!direction.isRight() && isLeftOkay(grid, x, y)) {
						y -= 1;
						direction = Direction.LEFT;
					} else if (!direction.isLeft() && isRightOkay(grid, x, y)) {
						y += 1;
						direction = Direction.RIGHT;
					} else {
						doContinue = false;
					}
				}

				if (doContinue && isLetter(grid[x][y])) {
					stringBuilder.append(grid[x][y]);
				}
			}

			return stringBuilder.toString();
		}

	}

	static class Star2 {

		static int getResult() {
			char[][] grid = getFormattedInput();
			int x = 0;
			int y = findYStartingPoint(grid);

			boolean doContinue = true;

			Direction direction = Direction.BOT;
			int stepCount = 0;

			while (doContinue) {
				stepCount++;

				if (direction.isBot() && isBotOkay(grid, x, y)) {
					x += 1;
				} else if (direction.isTop() && isTopOkay(grid, x, y)) {
					x -= 1;
				} else if (direction.isLeft() && isLeftOkay(grid, x, y)) {
					y -= 1;
				} else if (direction.isRight() && isRightOkay(grid, x, y)) {
					y += 1;
				} else {
					if (!direction.isTop() && isBotOkay(grid, x, y)) {
						x += 1;
						direction = Direction.BOT;
					} else if (!direction.isBot() && isTopOkay(grid, x, y)) {
						x -= 1;
						direction = Direction.TOP;
					} else if (!direction.isRight() && isLeftOkay(grid, x, y)) {
						y -= 1;
						direction = Direction.LEFT;
					} else if (!direction.isLeft() && isRightOkay(grid, x, y)) {
						y += 1;
						direction = Direction.RIGHT;
					} else {
						doContinue = false;
					}
				}
			}

			return stepCount;
		}

	}

	private enum Direction {
		BOT,
		TOP,
		LEFT,
		RIGHT;

		boolean isBot() {
			return Direction.BOT.name().equals(this.name());
		}

		boolean isTop() {
			return Direction.TOP.name().equals(this.name());
		}

		boolean isLeft() {
			return Direction.LEFT.name().equals(this.name());
		}

		boolean isRight() {
			return Direction.RIGHT.name().equals(this.name());
		}
	}

	private static boolean isBotOkay(char[][] grid, int x, int y) {
		if ((x + 1) < grid.length) {
			x += 1;
			return isLetter(grid[x][y]) || grid[x][y] == VERTICAL_LINE || grid[x][y] == CORNER || grid[x][y] == HORIZONTAL_LINE;
		} else {
			return false;
		}
	}

	private static boolean isTopOkay(char[][] grid, int x, int y) {
		if ((x - 1) >= 0) {
			x -= 1;
			return isLetter(grid[x][y]) || grid[x][y] == VERTICAL_LINE || grid[x][y] == CORNER || grid[x][y] == HORIZONTAL_LINE;
		} else {
			return false;
		}
	}

	private static boolean isLeftOkay(char[][] grid, int x, int y) {
		if ((y - 1) >= 0) {
			y -= 1;
			return isLetter(grid[x][y]) || grid[x][y] == VERTICAL_LINE || grid[x][y] == CORNER || grid[x][y] == HORIZONTAL_LINE;
		} else {
			return false;
		}
	}

	private static boolean isRightOkay(char[][] grid, int x, int y) {
		if ((y + 1) < grid[x].length) {
			y += 1;
			return isLetter(grid[x][y]) || grid[x][y] == VERTICAL_LINE || grid[x][y] == CORNER || grid[x][y] == HORIZONTAL_LINE;
		} else {
			return false;
		}
	}

	private static boolean isLetter(char c) {
		return Character.isLetter(c);
	}

	private static int findYStartingPoint(char[][] grid) {
		for (int i = 0; i < grid[0].length; ++i) {
			if (grid[0][i] == VERTICAL_LINE) {
				return i;
			}
		}
		return 0;
	}

	private static char[][] getFormattedInput() {
		String[] formattedInput = getInput().split("\\n");
		char[][] grid = new char[formattedInput.length][formattedInput[0].length()];

		for (int i = 0; i < formattedInput.length; ++i) {
			grid[i] = formattedInput[i].toCharArray();
		}

		return grid;
	}

	private static String getInput() {
		return "                                                                             |                                                                                                                           \n"
				+ "             +-------+       +-------+   +-+                                 | +-------------------------------------------+                   +---------------+     +-+ +---------------------------+   \n"
				+ "             |       |       |       |   | |                                 | |                                           |                   |               |     | | |                           |   \n"
				+ " +---------------------------+       |   | +---------------------------------|-|---------+   +-----------------------------------------------------------------|-----|-|-----+                       |   \n"
				+ " |           |       |               |   |                                   | |         |   |                             |                   |               |     | | |   |                       |   \n"
				+ " |           +-----------------------|---------------------------------------|-|---------|---|-----------------+           |                   |               | +---|-+ +-------------------------+ |   \n"
				+ " |                   |               |   |                                   | |         |   |                 |           |                   |               | |   |       |                     | |   \n"
				+ " |                   |         +-----|-+ |                 +-----------------|-+ +-------|---|-+               +---------------------------------------+       | |   | +-+   |     +-----+ +-+   +-|-|-+ \n"
				+ " |                   |         |     | | |                 |                 |   |       |   | |                           |                   |       |       | |   | | |   |     |     | | |   | | | | \n"
				+ " |           +---------------------------------------------+                 |   +-----------|-|-----------+               |                   |       |       | |   | | |   |     |     | | |   | | | | \n"
				+ " |           |       |         |     | | |                                   |           |   | |           |               |                   |       |       | |   | | |   |     |     | | |   | | | | \n"
				+ " |           | +-----|---------|-----|-|---------------+                     |           |   | |         +-|---------------|-----------+       |       |       | |   | | |   |   +-+     | | |   | | | | \n"
				+ " |           | |     |         |     | | |             |                     |           |   | |         | |               |           |       |       |       | |   | | |   |   |       | | |   | | | | \n"
				+ " |           | |     |         |     | | |             |                     |           | +----Q----------+               |           |       |       |       | |   | | |   |   |     +-|---+   | | | | \n"
				+ " |           | |     |         |     | | |             |                     |           | | | |         |                 |           |       |       |       | |   | | |   |   |     | | |     | | | | \n"
				+ " |           | |     |         |     | | |             | +---------------------------+   +-|---|---------|-------------------------------+     |     +---------|-|-----------|---|-----|---------|-+ | | \n"
				+ " |           | |     |         |     | | |             | |                   |       |     | | |         |                 |           | |     |     | |       | |   | | |   |   |     | | |     |   | | \n"
				+ " +-+ +-+     | |   +-----+     |     | +-|---------+   | |                   |       |     | | +-+       |                 |   +-------|-------------|-|---------|---|-|-----|---|-----|---|-----+   | | \n"
				+ "   | | |     | |   | |   |     |     |   |         |   | |                   |       |     | |   |       |                 |   |       | |     |     | |       | |   | | |   |   |     | | |         | | \n"
				+ " +-----|-+   | |   | |   +-----|-------------+     |   | |                   |       |     | |   |       |       +-----+   |   |   +---|-------|-----|-|-----+ | | +-|-|-|-+ | +-|---+ | | |         | | \n"
				+ " | | | | |   | |   | |         |     |   |   |     |   | |                   |       |     | |   |       |       |     |   |   |   |   | |     |     | |     | | | | | | | | | | |   | | | |         | | \n"
				+ " | | | | |   | |   | |         |     |   |   |     |   | |         +-----------------------------|-------|-------------|---------------|-------|-----+ |     +---|-|-|-|-----|-|---+ | | | |         | | \n"
				+ " | | | | |   | |   | |         |     |   |   |     |   | |         |         |       |     | |   |       |       |     |   |   |   |   | |     |       |       | | | | | | | | | | | | | | |         | | \n"
				+ " | +-----|-----|---------------|-----|---|---|---------|-|-------------------|-------------|-|---------+ |       +-------------|---|---|-------|-------|-------+ | | +---|-----|-|-------|-|-------+ | | \n"
				+ " |   | | |   | |   | |         |     |   |   |     |   | |         |         |       |     | |   |     | |             |   |   |   |   | |     |       |         | |   | | | | | | | | | | |       | | | \n"
				+ " +-------|---|-|---+ |         +-+   |   +---------|---|-|---------|---------|---------------|---|-----|---------------------------|---|-------|-------|-------------+ | | | | | | | | | | |       | | | \n"
				+ "     | | |   | |     |           |   |       |     |   | |         |         |       |     | |   |     | |             |   |   |   |   | |     |       |         | | | | | | | | | | | | | |       | | | \n"
				+ "   +-|---------|-----|-------+   |   |       |     |   | |   +---------------|-------------|-----|-------|-------------|---|-----------|-|-----|---------------------|-|-|-------------|-+ |       | | | \n"
				+ "   | | | |   | |     |       |   |   |       |     |   | |   |     |         |       |     | |   |     | |             |   |   |   |   | |     |       |         | | | | | | | | | | | |   |       | | | \n"
				+ " +-+ | +-|---------+ |       |   |   |       |     |   | |   |     |         | +-----------|-----------|-|-+     +---------|---|---|---|-|---------------------------------|-|---|---|---+ |       | | | \n"
				+ " |   |   |   | |   | |       |   |   |       |     |   | |   |     |         | |     |     | |   |     | | |     |     |   |   |   |   | |     |       |         | | | | | | | | | | | | | |       | | | \n"
				+ " |   +-------------|-|-----------|-----------------|-----|---------|-----------|-------------|---|-----|-+ |     |     |   |   |   |   +-|-------------|---------------------|-|-+ | | | | |       | | | \n"
				+ " |       |   | |   | |       |   |   |       |     |   | |   |     |         | |     |     | |   |     |   |     |     |   |   |   |     |     |       |         | | | | | | | |   | | | | |       | | | \n"
				+ " +-------+   | |   | |       |   |   |       |     +---|---+ | +-------------|-|-----------|-+   |     |   +-----|-----|-+ |   |   +-----|-----|-------|---------+ | | | | | | |   | | | | |       | | | \n"
				+ "             | |   | |       |   |   |       |         | | | | |   |         | |     |     |     |     |         |     | | |   |         |     |       |           | | | | | | |   | | | | |       | | | \n"
				+ " +-------------------------------|---|-------|---------|-|-|-------|-----------------|-----|---+ |     |   +---------------|---|---------|-----|---------------------+ | | | | |   | | | | |       | | | \n"
				+ " |           | |   | |       |   |   |       |         | | | | |   |         | |     |     |   | |     |   |     |     | | |   |         |     |       |           |   | | | | |   | | | | |       | | | \n"
				+ " |           | |   | |       | +-|-----------|---------|---|-------|---------|-------------|---------------|-----|---------|---|-------------------------------+   | +-|-|---|-|---+ | | | |       | | | \n"
				+ " |           | |   | |       | | |   |       |         | | | | |   |         | |     |     |   | |     |   |     |     | | |   |         |     |       |       |   | | | | | | |     | | | |       | | | \n"
				+ " |           | |   | |       | | | +-|-------|-----------|-|-|-|---|---------|-|---------------|-------|-------------------|-------------|-------------+       |   | | | | | | |     | | | |       | | | \n"
				+ " |           | |   | |       | | | | |       |         | | | | |   |         | |     |     |   | |     |   |     |     | | |   |         |     |               |   | | | | | | |     | | | |       | | | \n"
				+ " |           | |   | |       | | +-|-------------------|-|---|-----|-----------|-----|---------|-----------------|-------|-|---|---------|-----|-------------------|-+ | | | | |     | | | |       | | | \n"
				+ " |           | |   | |       | |   | |       |         | | | | |   |         | |     |     |   | |     |   |     |     | | |   |         |     |               |   |   | | | | |     | | | |       | | | \n"
				+ " |       +---|-|-----|-------|-------|-----------------------|-|---|---------|-----+ |     |   | |     |   +-+   |     | | |   |       +-|-----|---+           |   |   | | | | |     | +-|-------+ | | | \n"
				+ " |       |   | |   | |       | |   | |       |         | | | | |   |         | |   | |     |   | |     |     |   |     | | |   |       | |     |   |           |   |   | | | | |     |   | |     | | | | \n"
				+ " |       |   | |   | |       | |   | |       |         | | | | |   |         | |   | |     |   | | +---|---------|-----|-------|---------|---------|-----+     |   |   | | | | +---+ | +-----+   | | | | \n"
				+ " |       |   | |   | |       | |   | |       |         | | | | |   |         | |   | |     |   | | |   |     |   |     | | |   |       | |     |   |     |     |   |   | | | |     | | | | | |   | | | | \n"
				+ " |       |   | |   | |       | | +-|---------------------|---|-|---|-----------|---|-------|-----|-----|-----|-----------|-|---|---------|---------------|-+   |   |   | | | | +-+ | | | | | +-+ | | | | \n"
				+ " |       |   | |   | |       | | | | |       |         | | | | |   |         | |   | |     |   | | |   |     |   |     | | |   |       | |     |   |     | |   |   N   | | | | | | | | | | |   | | | | | \n"
				+ " |       | +-|-----|-|-------|-|-|---+       |         | | | | |   |         | |   | |     |   | | |   |     |   +-----|---|---|-----+ | |     |   |     | | +-|---|---|-------+ A | | | | | +---|-+ | | \n"
				+ " |       | | | |   | |       | | | |         |         | | | | X   |         | |   | |     |   | | |   |     |         | | |   |     | | |     |   |     | | | |   |   | | | |     | | | | | | | |   | | \n"
				+ " |       | | | |   | |       +-|-----------------------|-------|-------------|-|-----|-----|-----|---------------------|---|---------|---|-----------------|-|-----+   | | | |     | | +-----+ | |   | | \n"
				+ " |       | | | |   | |         | | |         |         | | | | |   |         | |   | |     |   | | |   |     |         | | |   |     | | |     |   |     | | | |       | | | |     | |   | |   | |   | | \n"
				+ " |       | | | |   | |         +-------------|---------|-|---|-|---|---------------|-|-----|---|-------------------------|-|-----------|-|---------------|-|-------------|-|-------|-+   | |   | |   | | \n"
				+ " |       | | | |   | |           | |         |         | | | | |   |         | |   | |     |   | | |   |     |         | | |   |     | | |     |   Y     | | | |       | | | |     |     | |   | |   | | \n"
				+ " +-------|-----|---+ |     +-----|-|-------+ |         | | | | |   |   +-----------|-|-------------|-------------+ +-------|---------|-------------|---------|---------+ | | | +-+ |     | +---|-|-----+ \n"
				+ "         | | | |     |     |     | |       | |         | | | | |   |   |     | |   | |     |   | | |   |     |   | |   | | |   |     | | |     |   |     | | | |         | | | | | |     |     | |   |   \n"
				+ "         | | | |     |     |     | |       | |         | +---|---------|-----|-----|-------|-------|---------------|-----+ |   |     | | |     |   |     | | | | +---+ +-----|-+ | +-----------|-+   |   \n"
				+ "         | | | |     |     |     | |       | |         |   | | |   |   |     | |   | |     |   | | |   |     |   | |   |   |   |     | | |     |   |     | | | | |   | | | | |   |       |     |     |   \n"
				+ "         +-|---|-----+     |     | |       | | +-------|-----+ |   |   |     | |   | |     |   | | |   |     |   | |   | +-|---------|-|-------|---|---------|-+ | +-------|-----|-+     |     |     |   \n"
				+ "           | | |           |     | |       | | |       |   |   |   |   |     | |   | |     |   | | |   |     |   | |   | | |   |     | | |     |   |     | | |   | | | | | | |   | |     |     |     |   \n"
				+ "           | | | +---+     |     | |       | +-+       |   |   |   |   |     | +-----------|-----|-----------|-------+ | | |   |     | | |     |   |     | | |   | | +-----|-|-----|-------+   |     |   \n"
				+ "           | | | |   |     |     | |       |           |   |   |   |   |     |     | |     |   | | |   |     |   | | | | | |   |     | | |     |   |     | | |   | |   | | | |   | |     | |   |     |   \n"
				+ "           | | | |   |     |     | |       |           |   |   |   |   |     +-------|-----|---|-|-|-------------|-|-|-------+ | +---|-|-|---------|-------+ +-+ | | +-|-|---|-+ | |     | |   |     |   \n"
				+ "           | | | |   |     |     | |       |           |   |   |   |   |           | |     |   | | |   |     |   | | | | | | | | |   | | |     |   |     |     | | | | | | | | | | |     | |   |     |   \n"
				+ "     +-----+ | | +---------|-----+ |       |           +-------|-+ |   |           | |     |   | | |   |   +---------|-|---|-|-------|---|-----|---|-------+ +-----|-----+ | | | +-|-----|-+   |     |   \n"
				+ "     |       | |     |     |       |       |               |   | | |   |           | |     |   | | |   |   | |   | | | | | | | | |   | | |     |   |     | | | | | | | |   | | |   |     |     |     |   \n"
				+ "     |       | |     +-------------|-------|---------------|-----|-----|-----------|-------|---|---|---|-----|-----|-----|---|-|-|---|-|-|-----|---------|-|-|-|-|-|-|-|---|-|---+ +-----|-----+     |   \n"
				+ "     |       | |           |       |       |               |   | | |   |           | |     |   | | |   |   | |   | | | | | | | | |   | | |     |   |     | | | | | | | |   | | | |       |           |   \n"
				+ "     |       | |           |   +---|-------|-------------------+ | |   |           | |     |   | | |   |   | |   | | | | | | | | |   | | |     | +-|-----------+ | | | |   | | | | +-------------+   |   \n"
				+ "     |       | |           |   |   |       |               |     | |   |           | |     |   | | |   |   | |   | | | | | | | | |   | | |     | | |     | | |   | | | |   | | | | |     |       |   |   \n"
				+ "     +---------|---------------|---|-------|---------------|-------|-----+         | | +---|---|-|-|---|-----|---|-|-----|---|---|---|-|-----------|-----|---|---|-+ | |   | | | | |     |     +-|-+ |   \n"
				+ "             | |           |   |   |       |               |     | |   | |         | | |   |   | | |   |   | |   | | | | | | | | |   | | |     | | |     | | |   |   | |   | | | | |     |     | | | |   \n"
				+ "             | |           |   | +-|-------|---------------------|-----------------|-|-----|-----------------|-----|---|-|-|---|---------------|-+ |     | | |   |   | |   | | | | |     |     | | | |   \n"
				+ "             | |           |   | | |       |               |     | |   | |         | | |   |   | | |   |   | |   | | | | | | | | |   | | |     |   |     | | |   |   | |   | | | | |     |     | | | |   \n"
				+ "             | |   +-------|-----|---------|---------------|-------|---|-|-----------|-|---|-----+ |   |   | |   | | | | | | | | |   | | |     |   |     | | |   |   | |   | | | | |     |     | | | |   \n"
				+ "             | |   |       |   | | |       |               |     | |   | |         | | |   |   |   |   |   | |   | | | | | | | | |   | | |     |   |     | | |   |   | |   | | | | |     |     | | | |   \n"
				+ "             | | +-|-------|---|-|-|-----+ |               +-----|-------------------+ |   |   |   |   |   +-|-----|-------+ | | |   | | |     |   |     | | |   |   | |   | | | | |     | +-+ | | +-|-+ \n"
				+ "             | | | |       |   | | |     | |                     | |   | |         |   |   |   |   |   |     |   | | | | |   | | |   | | |     |   |     | | |   |   | |   | | | | |     | | | | |   | | \n"
				+ "             | | | +-----------|---|-------|-+                   | |   | |         |   |   |   |   |   |     |   | | | | |   | | +---|---+     |   |     | | |   |   | |   | | | | |     | | | | |   | | \n"
				+ "             | | |         |   | | |     | | |                   | |   | |         |   |   |   |   |   |     |   | | | | |   | |     | |       |   |     | | |   |   | |   | | | | |     | | | | |   | | \n"
				+ "             | | |   +-----|---|---|-----|-|---------------------|-|-----------------------------------|-----|---|-|---|-|-----|-----|-|-------|---|---------|---|---|-------|-|-----------|-|-|-|---|-+ \n"
				+ "             | | |   |     |   | | |     | | |                   | |   | |         |   |   |   |   |   |     |   | | | | |   | |     | |       |   |     | | |   |   | |   | | | | |     | | | | |   |   \n"
				+ " +-------------|---------------|---|-----|-|-------------------+ | |   | |         |   |   |   |   |   |     |   | | +-|-|-----|-+   | |       |   |     | | |   |   | |   | | | | |     | | | | |   |   \n"
				+ " |           | | |   |     |   | | |     | | |                 | | |   | |         |   |   |   |   |   |     |   | |   | |   | | |   | |       |   |     | | |   |   | |   | | | | |     | | | | |   |   \n"
				+ " |           | | |   |     |   | | |     | | | +-------+       | | |   | |         |   |   | +-|-------------|---------|-|---|-|-----|-|-----------|-----|-|-------+ | +---------+ | +-------|-|---+ |   \n"
				+ " |           | | |   |     |   | | |     | | | |       |       | | |   | |         |   |   | | |   |   |     |   | |   | |   | | |   | |       |   |     | | |   | | |     | | |   | |   | | | | | | |   \n"
				+ " |           | | |   |     |   | | |     | | | |       |       | | |   | |         |   |   | | |   |   |     |   | |   +-|---|---+   | |       |   |     | | |   | | |     | | |   | |   | | | | | | |   \n"
				+ " |           | | |   |     |   | | |     | | | |       |       | | |   | |         |   |   | | |   |   |     |   | |     |   | |     | |       |   |     | | |   R | |     | | |   | |   | | | | | | |   \n"
				+ " |           | | |   |     |   | +-|-----|---+ |       |       | | |   | |         |   |   | | | +-----|---------|-------|---|-----+ | |       |   |     | | |   | | |     | | |   | |   +-|-|-+ | | |   \n"
				+ " |           | | |   |     |   |   |     | |   |       |       | | |   | |         |   |   | | | | |   |     |   | |     |   | |   | | |       |   |     | | |   | | |     | | |   | |     | |   | | |   \n"
				+ " |           | | |   |     |   |   |     | |   |       |       | | |   | |         |   |   | | | | |   |     |   | |     |   | |   | | |       |   |     | | +---+ | |     | | |   | |     | |   | | |   \n"
				+ " |           | | |   |     |   |   |     | |   |       |       | | |   | |         |   |   | | | | |   |     |   | |     |   | |   | | |       |   |     | |       | |     | | |   | |     | |   | | |   \n"
				+ " |           | | |   |     |   |   |     | |   |       |       | | |   | |         |   |   | | | | |   |     |   | |     |   | |   | | |       |   |     | |       | |     | | |   | |     | |   | | |   \n"
				+ " |           | | |   |     |   |   |     | |   |       |       | | |   | |         |   |   | | | | |   |     |   | |     |   | |   | | |       |   |     | |       | |     | | |   | |     | |   | | |   \n"
				+ " |           | | | +-|---------------------|-------------------|-------|-|---------|---|---|---|-------------|---|-|---------|-------|---------|---------|-|-------|-|-------|-------|-----|-+   | | |   \n"
				+ " |           | | | | |     |   |   |     | |   |       |       | | |   | |         |   |   | | | | |   |     |   | |     |   | |   | | |       |   |     | |       | |     | | |   | |     |     | | |   \n"
				+ " |           | | | | |     |   |   |     | |   |       |       | | |   | |         |   |   | | | | |   |     |   | |     |   | |   | | |       |   |     | |       | |     | | |   | |     |     | | |   \n"
				+ " |           | | | | |     |   |   |     | |   |       |       | | |   | |         |   |   | | | | |   |     |   | |     |   | |   | | |       |   |     | |       | |     | | |   | |     |     | | |   \n"
				+ " |           | | | | |     |   |   |     | |   |       |       | | |   | |         |   |   | | | | |   |     |   | |     |   | |   | | |       |   |     | |       | |     | | |   | |     |     | | |   \n"
				+ " |           | | | | |     |   |   |     | |   |       |       | | |   | |         |   |   | | | | |   |     |   | |     |   | |   | | |       |   |     | |       | |     | | |   | |     |     | | |   \n"
				+ " |           | | | | |     |   |   | +---------------------------+ |   | |         |   |   | | | | |   |     |   | |     |   | |   | | |       |   |     | |       | |     | | |   | |     |     | | |   \n"
				+ " |           | | | | |     |   |   | |   | |   J       |       |   |   | |         |   |   | | | | |   |     |   | |     |   | |   | | |       |   |     | |       | |     | | |   | |     |     | | |   \n"
				+ " |           | | | | |     |   |   | |   | |   |       |       |   |   | |         |   |   | | +-|-|---------|---+ |     |   | |   | | |       |   |     | |       | |     | | |   | |     |     | | |   \n"
				+ " |           | | | | |     |   |   | |   | |   |       |       |   |   | |         |   |   | |   | |   |     |     |     |   | |   | | |       |   |     | |       | |     | | |   | |     |     | | |   \n"
				+ " |         +-----|-|-|-----|-------|-|---|-|-----------+       |   |   | |         |   |   | |   | |   |     |     |     |   | |   | | |       |   |     | |       | |     | | |   | |     |     | | |   \n"
				+ " |         | | | | | |     |   |   | |   | |   |               |   |   | |         |   |   | |   | |   |     |     |     |   | |   | | |       |   |     | |       | |     | | |   | |     |     | | |   \n"
				+ " |         | | | | | |     |   |   | |   | |   |               |   |   | |   +-------------|-------|---|---+ |     |     |   | |   | | |       |   |     | |       | |     | | |   | |     |     | | |   \n"
				+ " |         | | | | | |     |   |   | |   | |   |               |   |   | |   |     |   |   | |   | |   |   | |     |     |   | |   | | |       |   |     | |       | |     | | |   | |     |     | | |   \n"
				+ " | +-------|-----|-+ |     |   |   | |   | |   |               |   |   | |   |     |   |   | |   | |   |   | |     |     |   | |   | | |       |   |     | |       | |     | | |   | |     |     | | |   \n"
				+ " | |       | | | |   |     |   |   | |   | |   |               |   |   | |   |     |   |   | |   | |   |   | |     |     |   | |   | | |       |   |     | |       | |     | | |   | |     |     | | |   \n"
				+ " | |     +---|-|-----|-----+   |   | |   | |   |     +---------|---------|---|-----|---|---|-------|---|---|-------|---------|-------|-|-------|-----------|-------|---+   | | |   | |   +---------+ |   \n"
				+ " | |     | | | | |   |         |   | |   | |   |     |         |   |   | |   |     |   |   | |   | |   |   | |     |     |   | |   | | |       |   |     | |       | | |   | | |   | |   | |     |   |   \n"
				+ " | +---------|---|-------------|---------|-|---|---------------|---|---|-----|-+   |   +-----|---|-|---|---|-------|-----|---------|---|-------|---|-------|-------|-|-------|---+ | |   | |     |   +-+ \n"
				+ " |       | | | | |   |         |   | |   | |   |     |         |   |   | |   | |   |       | |   | |   |   | |     |     |   | |   | | |       |   |     | |       | | |   | | | | | |   | |     |     | \n"
				+ " | +-----|-+ | | | +-|-----+   |   | |   | |   |     |         |   |   | |   | |   |       | |   | |   |   | |     |     |   | |   | | |       |   |     | |       | | |   | | | | | |   | |     |     | \n"
				+ " | |     |   | | | | C     |   |   | |   | |   |     |         |   |   | |   | |   |       | |   | |   |   | |     |     |   | |   | | |       |   |     | |       | | |   | | | | | |   | |     |     | \n"
				+ " | |     | +---|-+ +-------|---|---------|-|---------|-------------------|---|-----|-------|-------|---|---|-|-----|-----|-----|---|-|-|-------|---------------------|-----|-----|-+ |   | |     |     | \n"
				+ " | |     | | | |     |     |   |   | |   | |   |     |         |   |   | |   | |   |       | |   | |   |   | |     |     |   | |   | | |       |   |     | |       | | |   | | | |   |   | |     |     | \n"
				+ " | +-----|-|-|-|---+ |     |   |   | |   | |   |     |       +-|-------|-----|-|-------------|---------|---|-|-----|---------------|---------------------+ |       | | |   | | | |   |   | |     |     | \n"
				+ " |       | | | |   | |     |   |   | |   | |   |     |       | |   |   | |   | |   |       | |   | |   |   | |     |     |   | |   | | |       |   |       |       | | |   | | | |   |   | |     |     | \n"
				+ " | +-------|-----+ +-|-----|---|-----|---|-----|-----|---------|---|---|-|-------------------|---|---------+ |     |     |   | |   | | |       |   |       |       | | |   | | | |   |   | |     |     | \n"
				+ " | |     | | | | |   |     |   |   | |   | |   |     |       | |   |   | |   | |   |       | |   | |   |     |     |     |   | |   | | |       |   |       |       | | |   | | | |   |   | |     |     | \n"
				+ " +-|-----------|-|-+ |     |   |   | |   | |   |     |       | |   |   | |   | |   |       | |   | |   |     |     |     |   | |   | | |       |   |       |       | | +---|-|-+ |   |   | |     |     | \n"
				+ "   |     | | | | | | |     |   |   | |   | |   |     |       | |   |   | |   | |   |       | |   | |   |     |     |     |   | |   | | |       |   |       |       | |     | |   |   |   | |     |     | \n"
				+ "   +-+   | | | | +-|-------|---|---|-----|-|---------|-------|-----------|-----|-------------------|---|-----|-----+     |   | |   | | |       |   |       |       | +-----|-|--D----|---|-+     |     | \n"
				+ "     |   | | | |   | |     |   |   | |   | |   |     |       | |   |   | |   | |   |       | |   | |   |     |           |   | |   | | |       |   |       |       |       | |   |   |   |       |     | \n"
				+ "     |   | | | |   | |     |   |   | |   | | +-|-------------|-|---|---|-------+   |       +-------|---|-----|-----------|-----|---------------|-+ |       |       |       | |   |   |   |       |     | \n"
				+ "     |   | | | |   | |     |   |   | |   | | | |     |       | |   |   | |   |     |         |   | |   |     |           |   | |   | | |       | | |       |       |       | |   |   |   |       |     | \n"
				+ "     |   | | | |   | |     |   |   | |   | | | |     |       | |   |   | |   |     | +-----------|-----|-----|---------------------|-------------|-|-------+       |       | |   |   |   |       |     | \n"
				+ "     |   | | | |   | |     |   |   | |   | | | |     |       | |   |   | |   |     | |       |   | |   |     |           |   | |   | | |       | | |               |       | |   |   |   |       |     | \n"
				+ "     |   | | | |   +-|---------|---|-|---|-+ | |     |       | |   +---|-|---|-------|-------|---|-|---|---------------------+ |   | | |       | +-------------------------|-|---+   |   |       |     | \n"
				+ "     |   | | | |     |     |   |   | |   |   | |     |       | |       | |   |     | |       |   | |   |     |           |     |   | | |       |   |               |       | |       |   |       |     | \n"
				+ "     |   | | | |     |     |   |   | |   |   | |     |       | |       | |   |     | |       |   | |   |     |           | +---|---|-------------------------------|-------------+   |   |       |     | \n"
				+ "     |   | | | |     |     |   |   | |   |   | |     |       | |       | |   |     | |       |   | |   |     |           | |   |   | | |       |   |               |       | |   |   |   |       |     | \n"
				+ " +---+ +-+ +---------|---------------|---|-----------------+ | |       | |   |     | |       |   | |   |     |           | |   |   | | |       |   |               |       | +-------|-----------|-----+ \n"
				+ " |     |     | |     |     |   |   | |   |   | |     |     | | |       | |   |     | |       |   | |   |     |           | |   |   | | |       |   |               |       |     |   |   |       |       \n"
				+ " |     |     +-|-----|-----|---|---|-|-------|-------------|-|---------|-------+   | |       |   | |   |     |           | |   |   | | |       |   |               |       |     |   |   |       +-----+ \n"
				+ " |     |       |     |     |   |   | |   |   | |     |     | | |       | |   | |   | |       |   | |   |     |           | |   |   | | |       |   |               |       |     |   |   |             | \n"
				+ " |     |       |     |     |   +---------------------|---------|-------------|-|-------------|---|-|-----------------------|---|---+ | |       |   |               |       |     |   |   |             | \n"
				+ " |     |       |     |     |       | |   |   | |     |     | | |       | |   | |   | |       |   | |   |     |           | |   |     | |       |   |               |       |     |   |   |             | \n"
				+ " |     |       |     |     |       | |   |   | |     |     | | |       | |   | |   | |       |   | |   |     |           | |   |     | |       |   |               |       |     |   |   |             | \n"
				+ " |     |       |     |     |       | |   |   | |     |     | | |       | |   | |   | |       |   | |   |     |           | |   |     | |       |   |               |       |     |   |   |             | \n"
				+ " |     |       | +---|-------------|-----|---|-|-----|-------------------|-----+   | |       |   | |   |     |           | |   |     | |       |   |               |       |     |   |   |             | \n"
				+ " |     |       | |   |     |       | |   |   | |     |     | | |       | |   |     | |       |   | |   |     |           | |   |     | |       |   |               |       |     |   |   |             | \n"
				+ " +-+   | +-+   | |   |     |       | |   |   | |     +-----|-------------|---|-----|-|-------|-----------------------------|---|-----|-|-------|---------------------------|-----|-------|-------------+ \n"
				+ "   |   | | |   | |   |     |       | |   |   | |           | | |       | |   |     | |       |   | |   |     |           | |   |     | |       |   |               |       |     |   |   |               \n"
				+ " +-----|-|-------|---------|---------|---|-------------------|-----------|-----------|-----------------------------------|-|---------|-|-------|-----------------+ |       |     |   |   |               \n"
				+ " | |   | | |   | |   |     |       | |   |   | |           | | |       | |   |     | |       |   | |   |     |           | |   |     | |       |   |             | |       |     |   |   |               \n"
				+ " | |   | | |   | |   |     |       | |   |   | +-----------|-|-----------|---|-----|-------------|-----|-----|---------+ | |   |     | |       |   |             | |       |     |   |   |               \n"
				+ " | |   | | |   | |   |     |       | |   |   |             | | |       | |   |     | |       |   | |   |     |         | | |   |     | |       |   |             | |       |     |   |   |               \n"
				+ " | |   | | +-+ | |   |     |       | |   |   |             | | |       | |   |     | |       |   | |   |     |         | | |   |     | |       |   |             | |       |     |   |   |               \n"
				+ " | |   | |   | | |   |     |       | |   |   |             | | |       | |   |     | |       |   | |   |     |         | | |   |     | |       |   |             | |       |     |   |   |               \n"
				+ " | |   | |   | | |   |     |       | |   |   |             | | |       | |   |     | |       |   | |   |     |         | | |   |     | |       |   |             | |       |     |   |   |               \n"
				+ " | |   | |   | | |   |     |       | |   |   |             | | |       | |   |     | |       |   | |   |     |         | | |   |     | |       |   |             | |       |     |   |   |               \n"
				+ " | |   | |   | | |   |     |       | |   |   |   +---------+ | |       | |   |     | |       |   | |   |     |         | | |   |     | |       |   |       +-----|---------------+   |   |               \n"
				+ " | |   | |   | | |   |     |       | |   |   |   |           | |       | |   |     | |       |   | |   |     |         | | |   |     | |       |   |       |     | |       |         |   |               \n"
				+ " | +---|-+ +-|-------------|-------------------+ |           | |       | |   |     | |       |   | |   |     |         | | |   |     | |       |   |       |     | |       |         |   |               \n"
				+ " |     |   | | | |   |     |       | |   |   | | |           | |       | |   |     | |       |   | |   |     |         | | |   |     | |       |   |       |     | |       |         |   |               \n"
				+ " | +---+ +-|---|-----+     |       | |   |   | | |           | +-----------------------------|-+ | |   |     |         | | |   +-----|-|-------|-+ |       |     | |       |         |   |               \n"
				+ " | |     | | | | |         |       | |   |   | | |           |         | |   |     | |       | | | |   |     |         | | |         | |       | | |       |     | |       |         |   |               \n"
				+ " | |     | | | | |         |       | +---|---|-|-------------|---------|-----------------------|-------|-----|-----------|-------------|-------|-|---------|-------|-------|---------+   |               \n"
				+ " | |     | | | | |         |       |     |   | | |           |         | |   |     | |       | | | |   |     |         | | |         | |       | | |       |     | |       |             |               \n"
				+ " | |     | | | | |         |       |     |   | | |           |         | |   |     | |       | | | |   |     |         | | |         | |       | | |       +-------|-------|-------+     |               \n"
				+ " | |     | | | | |         |       |     |   | | |           |         | |   |     | |       | | | |   |     |         | | |         | |       | | |             | |       |       |     |               \n"
				+ " | |     | | | | |         |       |     |   | | |           |         | |   |     | |       | | | |   |     |         +-|-|---------|-------------|-------------|---------------------------------+     \n"
				+ " | |     | | | | |         |       |     |   | | |           |         | |   |     | |       | | | |   |     |           | |         | |       | | |             | |       |       |     |         |     \n"
				+ " | |     | | | | |         |       |     |   | | |           |         | +---|-----|-|-------|---|-|---------|-----------|-|-----------+       | | +-------------------------------|-----+         |     \n"
				+ " | |     | | | | |         |       |     |   | | |           |         |     |     | |       | | | |   |     |           | |         |         | |               | |       |       |               |     \n"
				+ " | |     +---|-|-|---------------+ |     |   | | | +-------------------|-+   |     | |       | | | |   |     |           | |         |         | |               | |       |       |               |     \n"
				+ " | |       | | | |         |     | |     |   | | | |         |         | |   |     | |       | | | |   |     |           | |         |         | |               | |       |       |               |     \n"
				+ " +-+   +-+ | | | |         |     | |     |   | | | |         |         | |   |     | |       | +-+ |   |     +-------------+         |         | |               | |       |       |               |     \n"
				+ "       | | | | | |         |     | |     |   | | | |         |         | |   |     | |       |     |   |                 |           |         | |               | |       |       |               |     \n"
				+ " +-------+ | +-|-|-+       |     | |     | +-----|-|---------|-----------|---------|-|-------|---------|-----------------------------|-----------+               | |       |       +---------------|---+ \n"
				+ " |     |   |   | | |       |     | |     | | | | | |         |         | |   |     | |       |     |   |                 |           |         |                 | |       |                       |   | \n"
				+ " |   +---------+ | |       |     +-|-------|-----|-----------|-----------|---|-------|-----+ |     |   |                 |           |         |                 | |       |                       |   | \n"
				+ " |   | |   |     | |       |       |     | | | | | |         |         | |   |     | |     | |     |   |                 |           |         |                 | |       |                       |   | \n"
				+ " |   | | +-|-----|-|---------------|-----|-|---|-----------------------|-----|-----+ |     +-|-----|---|-----------------|---------------------+                 | |       |                       |   | \n"
				+ " |   | | | |     | |       |       |     | | | | | |         |         | |   |       |       |     |   |                 |           |                           | |       |                       |   | \n"
				+ " |   | | | | +-------------+       |     +-|-+ | | |         |         | |   |       |       | +-------|-----------------|-----------+                           | |       |                       |   | \n"
				+ " |   | | | | |   | |               |       |   | | |         |         | |   |       |       | |   |   |                 |                                       | |       |                       |   | \n"
				+ " | +---|-|-+ |   | | +-------------|-------|---|---|-------------------+ |   +-----+ |       | +---|---------------------|---------------------------------------|-|-----------------------------------+ \n"
				+ " | | | | |   |   | | |             |       |   | | |         |           |         | |       |     |   |                 |                                       | |       |                       |     \n"
				+ " +-|-------------|---+         +---|-------+ +---|-|---------------------|-----------|-------------|---|-----------------|---------------------------------------|-|-------|---------------------------+ \n"
				+ "   | | | |   |   | |           |   |         | | | |         |           |         | |       |     |   |                 |                                       | |       |                       |   | \n"
				+ "   | | | |   |   | |       +-------------+   | | | |         |           |         | |       +-----|---------------------|-----------------------------------------|-----------------------------------+ \n"
				+ "   | | | |   |   | |       |   |   |     |   | | | |         |           |         | |             |   |                 |                                       | |       |                       |     \n"
				+ "   | | | +---|-----|----------F----|-----|---+ | | +-+       |           |         | |             |   |                 |   +-----------------------------------|-------------------------------------+ \n"
				+ "   | | |     |   | |       |   |   |     |     | |   |       |           |         | |             |   |                 |   |                                   | |       |                       |   | \n"
				+ "   | +-|-----|-----------------|-----------------------------|-----------------------|-------------|---------------------|---|---------------------+             | |       |                 +-+   | +-+ \n"
				+ "   |   |     |   | |       |   |   |     |     | |   |       |           |         | |             |   |                 |   |                     |             | |       |                 | |   | |   \n"
				+ "   |   |     |   | |       |   |   +-----------|-|-----------|-----------|---------|-|-------------|---|---------------------|---------------------+             | |       |                 | |   | |   \n"
				+ "   |   |     |   | |       |   |         |     | |   |       |           |         | |             |   |                 |   |                                   | |       |                 | |   | |   \n"
				+ "   |   |     |   | |       +---|---------|-------+   |       |           |         | |             |   |                 +---------------------------------------|---------------------------+ |   | |   \n"
				+ "   |   |     |   | |           |         |     |     |       |           |         | |             |   |                     |                                   | |       |                   |   | |   \n"
				+ "   |   |     |   | +-----------+         |     +-+   |       |           +---------|-------------------|---------------------+         +---------------------------+       |                   |   | |   \n"
				+ "   |   |     |   |                       |       |   |       |                     | |             |   |                               |                         |         |                   |   | |   \n"
				+ " +-+   |   +-----|-----------------------|-------|---|-------+                     +-+             +---|-------------------------------+                         |     +---+                   |   +-+   \n"
				+ " |     |   | |   |                       |       |   |                                                 |                                                         |     |                       |         \n"
				+ " +-----+   +-+   +-----------------------+       +---+                                                 +---------------------------------------------------------+     +-----------------------+         \n"
				+ "                                                                                                                                                                                                         \n";
	}

}
